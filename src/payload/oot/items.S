#include <combo/asm.h>

/* Patch GetItemCollectBehavior */
PATCH_START(0x80071420)
  j GetItemCollectBehavior
   nop
PATCH_END

/* Expand link's chest item to 16 bits */
PATCH_LOAD_STORE 16, 0
.int 0x80022cd0
.int 0x80830450
.int 0x808312e8
.int 0x80831944
.int 0x80838584
.int 0x808385b8
.int 0x8083c64c
.int 0x8083c6b4
.int 0x8083c7b4
.int 0x8083c880
.int 0x8083d9ec
.int 0x808439e8
.int 0x8084562c
.int 0x80845630
.int 0x8084563c
.int 0x80845820
.int 0x808458a8
.int 0x8084c04c
.int 0x8084c0cc
.int 0x8084c13c
.int 0x8084c234
.int 0x8084c29c
.int 0x8084c8a8
PATCH_END

/* Make link's gi held item unsigned */
PATCH_LOAD_STORE 8, 1
.int 0x8007b438
.int 0x8007b44c
.int 0x8007bdfc
.int 0x8007be18
.int 0x8007bed0
.int 0x8007bf04
.int 0x8007bf04
.int 0x8007bf80
.int 0x80831318
.int 0x8083131c
.int 0x80848b88
.int 0x8084c040
.int 0x8084d26c
.int 0x8084d2d0
.int 0x8084d2dc
.int 0x8084d360
PATCH_END

/* Hook into our custom item adding function */
PATCH_START(0x8084c11c)
  sw v1,0x24(sp)
PATCH_END

PATCH_START(0x8084c128)
  lw a1,0x24(sp)
PATCH_END

PATCH_START(0x8084c130)
  jal comboAddItemFromChest
   nop
PATCH_END

/* Replace every call to GiveItem */
PATCH_REL_JUMP comboGiveItem
.int 0x8001282c
.int 0x80022d08
.int 0x808873ec
.int 0x8088b324
.int 0x808ae804
.int 0x808ae8a0
.int 0x808d0f14
.int 0x808d1cf0
.int 0x80909518
.int 0x80923cbc
.int 0x80923cd8
.int 0x80923d7c
.int 0x80923ec8
.int 0x80924278
.int 0x8095457c
.int 0x809a130c
.int 0x809a140c
.int 0x809f1288
.int 0x80a279b0
.int 0x80a27a14
.int 0x80a28604
.int 0x80a28700
.int 0x80a2a5bc
.int 0x80a2b834
.int 0x80a42644
.int 0x80a427e0
.int 0x80a5930c
.int 0x80a5c978
.int 0x80a5e230
.int 0x80a5e2cc
.int 0x80a65c54
.int 0x80a6e550
.int 0x80a6e5e8
.int 0x80a6f7dc
.int 0x80a6f860
.int 0x80a75734
.int 0x80a75750
.int 0x80a757a8
.int 0x80a757c4
.int 0x80a757e4
.int 0x80a7f0f0
.int 0x80a7f16c
.int 0x80a8c31c
.int 0x80a901d0
.int 0x80a90298
.int 0x80a9e95c
.int 0x80a9e9a0
.int 0x80a9ec70
.int 0x80a9edc4
.int 0x80a9eea8
.int 0x80a9ffd8
.int 0x80aa006c
.int 0x80aa08dc
.int 0x80aa0998
.int 0x80aa1058
.int 0x80aa1104
.int 0x80aabc6c
.int 0x80aabcec
.int 0x80aac004
.int 0x80aac10c
.int 0x80aac7e4
.int 0x80aac840
.int 0x80aacce8
.int 0x80aacd48
.int 0x80aaf0ec
.int 0x80aaf168
.int 0x80ab3d04
.int 0x80ab3d28
.int 0x80abe66c
.int 0x80ac08a0
.int 0x80ad43ec
.int 0x80ad6cc8
.int 0x80ad8940
.int 0x80ad89a4
.int 0x80ad9e10
.int 0x80ad9eac
.int 0x80adb708
.int 0x80ae5138
.int 0x80ae6e84
.int 0x80b19418
.int 0x80b194ec
.int 0x80b24830
.int 0x80b248c4
.int 0x80b28268
.int 0x80b4e7d8
.int 0x80b4e854
.int 0x80b56ff4
.int 0x80b5ad5c
.int 0x80b6b364
.int 0x80b6b3d4
.int 0x80b77f30
.int 0x80b77fcc
.int 0x80b7f1e8
.int 0x80b7f27c
.int 0x80b832a4
.int 0x80b8333c
PATCH_END
